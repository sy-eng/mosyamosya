\documentclass{jsarticle}
\usepackage{amsmath,amssymb,amsfonts}

\begin{document}
紙面の関係で省略されている定理4.8の証明に関して考えてみる。

直感的には重さあたりの価値$\frac{p_i}{w_i}$が大きいものをナップサックに入れるようにする。

(4.108)が最適値になっていることを示す。

今、ナップサックに入っている重量は
\begin{equation}
\sum_j w_j x_j = \sum_{j=1}^k w_j + w_{k+1}\frac{C-\sum_{j=1}^k w_j}{w_{k+1}} = C
\end{equation}
となっており、制限一杯となっている。

(本にはないが、$p_i, w_i \geq 0$としておく、そうしないと、上記の式で、$p_i<0, w_i>0$の$x_i$が0でないときは、$x_i=0$とするほうが改善するし、$p_i>0, w_i<0$のときは、容量、価値ともに増やすので、ぜひとも入れたい。)

そのため、単純に追加することはできない。すでにナップサックに入っているものを$\Delta_x$だけ、別のものに入れ替えて、目的関数を改善できない(目的関数が大きくならない)ことを示せれば、(4.108)が最適値であることが言える。

$w_i x_i$を$\Delta_w$だけ減らして、$w_j x_j$を$\Delta_w$だけ増やすことを考える。

それによる目的関数の変化$\Delta_p$を考えると、
\begin{equation}
\Delta_p = p_j x_j - p_i x_i = \frac{p_j}{w_j} w_j x_j - \frac{p_i}{w_i} w_i x_i = \frac{p_j}{w_j} \Delta_w - \frac{p_i}{w_i} \Delta_w = (\frac{p_j}{w_j} - \frac{p_i}{w_i}) \Delta_w
\end{equation}
(4.107)の仮定より、$\Delta_p \leq 0$となり、目的関数は改善できない。(変化しない場合もありうるので、($i=k+1,j=k+1$とする場合も含め、)一意の解にはならないが改善はしない。)

そのため、(4.108)が最適解になっている。
\end{document}
